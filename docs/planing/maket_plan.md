# План создания первого работающего макета (MVP)

Этот документ описывает пошаговый план создания первого прототипа с использованием рекомендованного технологического стека: **Electron + React + TypeScript**.

---

## Шаги (этопый план)

### Шаг 0: Настройка окружения

1. Установить `Node.js` и `Git`.
2. Создать проект с помощью готового шаблона, например, `electron-react-boilerplate` или аналогичного. Это сразу настроит нам связку Electron + React + TypeScript и всю необходимую конфигурацию сборки.
3. Установить зависимости: `better-sqlite3` для базы данных и `chokidar` для отслеживания файлов.

### Шаг 1: Ядро проекта — работа с базой данных и файлами

1. **Описать схему БД:** Создать `schema.sql` файл, который описывает все таблицы MVP (`narrative_elements`, `world_objects`, `connections` и т.д.).
2. **Написать "Сервис Проекта":** Создать класс или модуль, который будет:
    * **Создавать новый проект:** Принимает путь к папке, создает там файл `project.sqlite`, исполняет на нем `schema.sql` и создает папки `/narrative` и `/world`.
    * **Открывать существующий проект:** Подключается к файлу `project.sqlite` в указанной папке.

### Шаг 2: Левая панель — Дерево проекта

1. Создать компонент `React`, который читает из БД таблицу `narrative_elements`.
2. Отобразить эти данные в виде вложенного дерева (Часть → Глава → Сцена).
3. Сделать так, чтобы при клике на элемент дерева его `ID` сохранялся как "текущий выбранный элемент".

### Шаг 3: Центральная панель — Отображение контента и кнопка "Открыть"

1. Создать компонент, который следит за "текущим выбранным элементом".
2. Когда элемент выбран, компонент берет его `ID`, делает запрос в БД, чтобы получить путь к `.md` файлу.
3. Читает содержимое этого файла и отображает его на экране (используя библиотеку `react-markdown` для красивого форматирования).
4. Добавить кнопку **"Открыть во внешнем редакторе"**, которая будет вызывать `shell.openPath()` из API Electron, передавая путь к файлу.

### Шаг 4: "Магия" — Синхронизация изменений

1. Запустить `Chokidar` при открытии проекта, чтобы он "слушал" изменения во всех `.md` файлах внутри папки проекта.
2. Настроить обработчик: если изменился файл, который в данный момент открыт в центральной панели, — автоматически перечитать его и обновить отображение. Это сразу покажет пользователю главную фичу в действии.

### Шаг 5: Создание и редактирование структуры

1. Добавить контекстное меню (правый клик) на элементы дерева в левой панели.
2. Реализовать пункт "Создать главу/сцену": он добавляет запись в БД и создает пустой `.md` файл на диске. Дерево должно автоматически обновиться.
3. Реализовать базовый `drag-and-drop` для элементов дерева, который будет изменять их порядок в базе данных.

---

Выполнение этих 5 шагов позволит получить рабочий макет, который наглядно демонстрирует всю основную идею и ценность приложения. Он будет неполным, но уже абсолютно рабочим и готовым для тестирования.
